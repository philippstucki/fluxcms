<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos  -->
			<title>File Source for sitemap.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
											</head>
		<body>
						<h1>Source for file sitemap.php</h1>
<p>Documentation is available at <a href="../popoon/_sitemap_php.html">sitemap.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a><span class="src-comm">// +----------------------------------------------------------------------+</span></li>
<li><a name="a3"></a><span class="src-comm">// | popoon                                                               |</span></li>
<li><a name="a4"></a><span class="src-comm">// +----------------------------------------------------------------------+</span></li>
<li><a name="a5"></a><span class="src-comm">// | Copyright (c) 2001,2002,2003,2004 Bitflux GmbH                       |</span></li>
<li><a name="a6"></a><span class="src-comm">// +----------------------------------------------------------------------+</span></li>
<li><a name="a7"></a><span class="src-comm">// | Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);      |</span></li>
<li><a name="a8"></a><span class="src-comm">// | you may not use this file except in compliance with the License.     |</span></li>
<li><a name="a9"></a><span class="src-comm">// | You may obtain a copy of the License at                              |</span></li>
<li><a name="a10"></a><span class="src-comm">// | http://www.apache.org/licenses/LICENSE-2.0                           |</span></li>
<li><a name="a11"></a><span class="src-comm">// | Unless required by applicable law or agreed to in writing, software  |</span></li>
<li><a name="a12"></a><span class="src-comm">// | distributed under the License is distributed on an &quot;AS IS&quot; BASIS,    |</span></li>
<li><a name="a13"></a><span class="src-comm">// | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or      |</span></li>
<li><a name="a14"></a><span class="src-comm">// | implied. See the License for the specific language governing         |</span></li>
<li><a name="a15"></a><span class="src-comm">// | permissions and limitations under the License.                       |</span></li>
<li><a name="a16"></a><span class="src-comm">// +----------------------------------------------------------------------+</span></li>
<li><a name="a17"></a><span class="src-comm">// | Author: Christian Stocker &lt;chregu@bitflux.ch&gt;                        |</span></li>
<li><a name="a18"></a><span class="src-comm">// +----------------------------------------------------------------------+</span></li>
<li><a name="a19"></a><span class="src-comm">//</span></li>
<li><a name="a20"></a><span class="src-comm">// $Id: fsource_popoon__sitemap.php.html,v 1.2 2004/03/08 07:37:48 chregu Exp $</span></li>
<li><a name="a21"></a>&nbsp;</li>
<li><a name="a20"></a>&nbsp;</li>
<li><a name="a21"></a>&nbsp;</li>
<li><a name="a22"></a><span class="src-doc">/**</span></li>
<li><a name="a23"></a><span class="src-doc">* Class for doing the sitemap parsing stuff</span></li>
<li><a name="a24"></a><span class="src-doc">*</span></li>
<li><a name="a25"></a><span class="src-doc">* </span><span class="src-doc-coretag">@author</span><span class="src-doc">   Christian Stocker &lt;chregu@bitflux.ch&gt;</span></li>
<li><a name="a26"></a><span class="src-doc">* </span><span class="src-doc-coretag">@version</span><span class="src-doc">  $Id: fsource_popoon__sitemap.php.html,v 1.2 2004/03/08 07:37:48 chregu Exp $</span></li>
<li><a name="a27"></a><span class="src-doc">* </span><span class="src-doc-coretag">@package</span><span class="src-doc">  popoon</span></li>
<li><a name="a28"></a><span class="src-doc">*/</span></li>
<li><a name="a29"></a>&nbsp;</li>
<li><a name="a30"></a>&nbsp;</li>
<li><a name="a31"></a><span class="src-key">class </span><a href="../popoon/popoon_sitemap.html">popoon_sitemap</a> <span class="src-sym">{</span></li>
<li><a name="a32"></a>&nbsp;</li>
<li><a name="a33"></a>&nbsp;</li>
<li><a name="a34"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$maps">$maps</a> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a35"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$file">$file</a> = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a36"></a>    <span class="src-key">public </span><a href="../popoon/popoon_sitemap.html#var$uri">$uri</a> = <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a37"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$xml">$xml</a> = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a38"></a>&nbsp;</li>
<li><a name="a39"></a>    <span class="src-doc">/**</span></li>
<li><a name="a40"></a><span class="src-doc">     * Contains the header, which will be output just before serializing</span></li>
<li><a name="a41"></a><span class="src-doc">     *</span></li>
<li><a name="a42"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a43"></a><span class="src-doc">     */</span></li>
<li><a name="a44"></a>    <span class="src-key">public </span><a href="../popoon/popoon_sitemap.html#var$header">$header</a> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a45"></a>&nbsp;</li>
<li><a name="a46"></a>&nbsp;</li>
<li><a name="a47"></a>    <span class="src-doc">/**</span></li>
<li><a name="a48"></a><span class="src-doc">     * HTTP response code which is sent with the first header</span></li>
<li><a name="a49"></a><span class="src-doc">     *</span></li>
<li><a name="a50"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a51"></a><span class="src-doc">     */</span></li>
<li><a name="a52"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$responseCode">$responseCode</a> = <span class="src-id">NULL</span><span class="src-sym">;</span></li>
<li><a name="a53"></a>&nbsp;</li>
<li><a name="a54"></a>    <span class="src-doc">/**</span></li>
<li><a name="a55"></a><span class="src-doc">     * The contenttype</span></li>
<li><a name="a56"></a><span class="src-doc">     *</span></li>
<li><a name="a57"></a><span class="src-doc">     * should be set within components (resp. serializers) with</span></li>
<li><a name="a58"></a><span class="src-doc">     * $this-&gt;sitemap-&gt;setContentType($type);</span></li>
<li><a name="a59"></a><span class="src-doc">     *</span></li>
<li><a name="a60"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span><span class="src-doc">contenttype</span></li>
<li><a name="a61"></a><span class="src-doc">     */</span></li>
<li><a name="a62"></a>&nbsp;</li>
<li><a name="a63"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$contentType">$contentType</a> = <span class="src-str">&quot;text/html&quot;</span><span class="src-sym">;</span></li>
<li><a name="a64"></a>    <span class="src-doc">/**</span></li>
<li><a name="a65"></a><span class="src-doc">     * The Directory, where the cached sitemaps should be saved</span></li>
<li><a name="a66"></a><span class="src-doc">     *</span></li>
<li><a name="a67"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a68"></a><span class="src-doc">     */</span></li>
<li><a name="a69"></a>      <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$cacheDir">$cacheDir</a> = <span class="src-str">&quot;./tmp/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a70"></a>&nbsp;</li>
<li><a name="a71"></a>&nbsp;</li>
<li><a name="a72"></a>    <span class="src-doc">/**</span></li>
<li><a name="a73"></a><span class="src-doc">     * Contains instance of ComponentCache or false</span></li>
<li><a name="a74"></a><span class="src-doc">     *</span></li>
<li><a name="a75"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">mixed </span></li>
<li><a name="a76"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@see</span><span class="src-doc"> enableCaching(), disableCaching()</span></li>
<li><a name="a77"></a><span class="src-doc">     */</span></li>
<li><a name="a78"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$componentCache">$componentCache</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a79"></a>&nbsp;</li>
<li><a name="a80"></a>    <span class="src-key">public </span><a href="../popoon/popoon_sitemap.html#var$outputCache">$outputCache</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a81"></a>    <span class="src-doc">/**</span></li>
<li><a name="a82"></a><span class="src-doc">    * The directory, where the xslt documents for</span></li>
<li><a name="a83"></a><span class="src-doc">    * sitemap 2 php translation are.</span></li>
<li><a name="a84"></a><span class="src-doc">    *</span></li>
<li><a name="a85"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a86"></a><span class="src-doc">    */</span></li>
<li><a name="a87"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$sm2php_xsl_dir">$sm2php_xsl_dir</a> = <span class="src-str">&quot;popoon/sitemap/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a88"></a>&nbsp;</li>
<li><a name="a89"></a>    <span class="src-doc">/**</span></li>
<li><a name="a90"></a><span class="src-doc">     * The XSL File for transforming sitemap.xsl to a cached php file</span></li>
<li><a name="a91"></a><span class="src-doc">     *</span></li>
<li><a name="a92"></a><span class="src-doc">     * You shouldn't have to change it.</span></li>
<li><a name="a93"></a><span class="src-doc">     *</span></li>
<li><a name="a94"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a95"></a><span class="src-doc">     */</span></li>
<li><a name="a96"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$sm2php_xsl">$sm2php_xsl</a> = <span class="src-str">&quot;sitemap2php.xsl&quot;</span><span class="src-sym">;</span></li>
<li><a name="a97"></a>&nbsp;</li>
<li><a name="a98"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$sm2phpincludes_xsl">$sm2phpincludes_xsl</a> = <span class="src-str">&quot;sitemap2phpincludes.xsl&quot;</span><span class="src-sym">;</span></li>
<li><a name="a99"></a>    </li>
<li><a name="a100"></a>    </li>
<li><a name="a101"></a>    <span class="src-key">private </span><a href="../popoon/popoon_sitemap.html#var$options">$options</a><span class="src-sym">;</span></li>
<li><a name="a102"></a>    </li>
<li><a name="a103"></a>    <span class="src-doc">/**</span></li>
<li><a name="a104"></a><span class="src-doc">     * Construtor</span></li>
<li><a name="a105"></a><span class="src-doc">     *</span></li>
<li><a name="a106"></a><span class="src-doc">     *  Almost everything happens here. The cached sitemap is generated here, if it</span></li>
<li><a name="a107"></a><span class="src-doc">     *   doesn't exist or if it's older</span></li>
<li><a name="a108"></a><span class="src-doc">     *  Then this sitemap is included and the code in it is run</span></li>
<li><a name="a109"></a><span class="src-doc">     *</span></li>
<li><a name="a110"></a><span class="src-doc">     *  </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$sitemapFile </span><span class="src-doc">the location of sitemap.xml, can be relativ</span></li>
<li><a name="a111"></a><span class="src-doc">     *  </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$uri </span><span class="src-doc">the uri of the call, optional (takes _SERVER[&quot;REQUEST_URI&quot;] then)</span></li>
<li><a name="a112"></a><span class="src-doc">     *  </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">array </span><span class="src-doc-var">$options </span><span class="src-doc">options, to be defined</span></li>
<li><a name="a113"></a><span class="src-doc">     *  </span><span class="src-doc-coretag">@access</span><span class="src-doc"> public</span></li>
<li><a name="a114"></a><span class="src-doc">     *  </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">bool </span></li>
<li><a name="a115"></a><span class="src-doc">     */</span></li>
<li><a name="a116"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#method__construct">__construct</a><span class="src-sym">(</span><span class="src-var">$sitemapFile</span><span class="src-sym">, </span><span class="src-var">$uri</span>= <span class="src-id">null</span><span class="src-sym">, </span><span class="src-id">popoon_classes_config </span><span class="src-var">$options </span>= <span class="src-id">NULL</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a117"></a>&nbsp;</li>
<li><a name="a118"></a>        <span class="src-comm">//replace class-properties by values in the options-array()</span></li>
<li><a name="a119"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$options">options</a> = <span class="src-var">$options</span><span class="src-sym">;</span></li>
<li><a name="a120"></a>        </li>
<li><a name="a121"></a>        <span class="src-comm">//FIXME use new config object class...</span></li>
<li><a name="a122"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'sm2php_xsl_dir'</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; isset<span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'sm2php_xsl'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a123"></a>            <span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'sm2php_xsl_dir'</span><span class="src-sym">] </span>= <a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'sm2php_xsl'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a124"></a>            <span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'sm2php_xsl'</span><span class="src-sym">] </span>= <a href="http://www.php.net/basename">basename</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'sm2php_xsl'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a125"></a>        <span class="src-sym">}</span></li>
<li><a name="a126"></a>&nbsp;</li>
<li><a name="a127"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$options </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a128"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">$key</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a129"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">$key </span>= <span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a130"></a>            <span class="src-sym">}</span></li>
<li><a name="a131"></a>        <span class="src-sym">}</span></li>
<li><a name="a132"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$file">file</a> = <span class="src-var">$sitemapFile</span><span class="src-sym">;</span></li>
<li><a name="a133"></a>&nbsp;</li>
<li><a name="a134"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$uri </span>=== <span class="src-id">null</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a135"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a> = <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">&quot;REQUEST_URI&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a136"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a137"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a> = <span class="src-var">$uri</span><span class="src-sym">;</span></li>
<li><a name="a138"></a>        <span class="src-sym">}</span></li>
<li><a name="a139"></a>&nbsp;</li>
<li><a name="a140"></a>        <span class="src-comm">//generate paths and ids</span></li>
<li><a name="a141"></a>        <span class="src-var">$sitemapRealPath </span>= <a href="http://www.php.net/realpath">realpath</a><span class="src-sym">(</span><span class="src-var">$sitemapFile</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a142"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$sitemapRealPath</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a143"></a>            <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Sitemap</span> <span class="src-var">$sitemapFile</span> <span class="src-id">does</span> <span class="src-id">not</span> <span class="src-id">exist</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a144"></a>        <span class="src-sym">}</span></li>
<li><a name="a145"></a>        <span class="src-var">$sitemapId </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodgenerateSitemapID">generateSitemapID</a><span class="src-sym">(</span><span class="src-var">$sitemapRealPath</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a146"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$cacheDir">cacheDir</a><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">) </span>!= <span class="src-str">&quot;/&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a147"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$cacheDir">cacheDir</a> = <span class="src-id"><a href="../popoon/_examples_slideml_index_php.html#defineBX_PROJECT_DIR">BX_PROJECT_DIR</a></span>.<span class="src-str">&quot;/&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$cacheDir">cacheDir</a><span class="src-sym">;</span></li>
<li><a name="a148"></a>        <span class="src-sym">}</span></li>
<li><a name="a149"></a>        <span class="src-var">$sitemapCachedFile </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$cacheDir">cacheDir</a> . <span class="src-var">$sitemapId</span><span class="src-sym">;</span></li>
<li><a name="a150"></a>        <span class="src-comm">//check if sitemapCache does exists and if it's older than the sitemap.xml</span></li>
<li><a name="a151"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">! </span><span class="src-sym">(</span><a href="http://www.php.net/file_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/filemtime">filemtime</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">) </span>&gt;= <a href="http://www.php.net/filemtime">filemtime</a><span class="src-sym">(</span><span class="src-var">$sitemapRealPath</span><span class="src-sym">)))</span></li>
<li><a name="a152"></a>            <span class="src-sym">{</span></li>
<li><a name="a153"></a>                <span class="src-comm">//if it is, make new sitemapCached file</span></li>
<li><a name="a154"></a>                <span class="src-var">$err </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsitemap2php">sitemap2php</a><span class="src-sym">(</span><span class="src-var">$sitemapRealPath</span><span class="src-sym">,</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a155"></a>            <span class="src-sym">}</span></li>
<li><a name="a156"></a>&nbsp;</li>
<li><a name="a157"></a>         <span class="src-var">$err </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodrunSitemap">runSitemap</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a158"></a>&nbsp;</li>
<li><a name="a159"></a>    <span class="src-sym">}</span></li>
<li><a name="a160"></a>&nbsp;</li>
<li><a name="a161"></a>    <span class="src-doc">/**</span></li>
<li><a name="a162"></a><span class="src-doc">     * Runs the cached Sitemap</span></li>
<li><a name="a163"></a><span class="src-doc">     *</span></li>
<li><a name="a164"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$sitemapCachedFile </span><span class="src-doc">location of the cached file</span></li>
<li><a name="a165"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">true on success, pear error on error</span></li>
<li><a name="a166"></a><span class="src-doc">     */</span></li>
<li><a name="a167"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodrunSitemap">runSitemap</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a168"></a>        <span class="src-comm">//include the sitemap file</span></li>
<li><a name="a169"></a>        <span class="src-var">$pipelineHit </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a170"></a>        <span class="src-inc">include </span><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a171"></a>&nbsp;</li>
<li><a name="a172"></a>    <span class="src-sym">}</span></li>
<li><a name="a173"></a>&nbsp;</li>
<li><a name="a174"></a>    <span class="src-doc">/**</span></li>
<li><a name="a175"></a><span class="src-doc">     * Sets a header, which is output just before the serializer</span></li>
<li><a name="a176"></a><span class="src-doc">     *</span></li>
<li><a name="a177"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$name </span><span class="src-doc">name of the header</span></li>
<li><a name="a178"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$value </span><span class="src-doc">value of the header</span></li>
<li><a name="a179"></a><span class="src-doc">     */</span></li>
<li><a name="a180"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a181"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$header">header</a><span class="src-sym">[</span><span class="src-var">$name</span><span class="src-sym">] </span>= <span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a182"></a>    <span class="src-sym">}</span></li>
<li><a name="a183"></a>&nbsp;</li>
<li><a name="a184"></a>    </li>
<li><a name="a185"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetHeaderIfNotExists">setHeaderIfNotExists</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a186"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$header">header</a><span class="src-sym">[</span><span class="src-var">$name</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a187"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a188"></a>        <span class="src-sym">}</span></li>
<li><a name="a189"></a>    <span class="src-sym">}</span></li>
<li><a name="a190"></a>    </li>
<li><a name="a191"></a>    <span class="src-doc">/**</span></li>
<li><a name="a192"></a><span class="src-doc">     * Sets a HTTP response code, which is sent with the first header</span></li>
<li><a name="a193"></a><span class="src-doc">     *</span></li>
<li><a name="a194"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">int </span><span class="src-doc-var">$value </span><span class="src-doc">response code value</span></li>
<li><a name="a195"></a><span class="src-doc">     */</span></li>
<li><a name="a196"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetResponseCode">setResponseCode</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a197"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$responseCode">responseCode</a> = <span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a198"></a>    <span class="src-sym">}</span></li>
<li><a name="a199"></a>&nbsp;</li>
<li><a name="a200"></a>    <span class="src-doc">/**</span></li>
<li><a name="a201"></a><span class="src-doc">     * Sets a header, and directly outputs it</span></li>
<li><a name="a202"></a><span class="src-doc">     *</span></li>
<li><a name="a203"></a><span class="src-doc">     * Very useful in DomStart of serializers, as the printHeader()</span></li>
<li><a name="a204"></a><span class="src-doc">     *  function is called before...</span></li>
<li><a name="a205"></a><span class="src-doc">     *</span></li>
<li><a name="a206"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$name </span><span class="src-doc">name of the header</span></li>
<li><a name="a207"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$value </span><span class="src-doc">value of the header</span></li>
<li><a name="a208"></a><span class="src-doc">     */</span></li>
<li><a name="a209"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetHeaderAndPrint">setHeaderAndPrint</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a210"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a211"></a>        <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$name</span>: <span class="src-var">$value</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a212"></a>    <span class="src-sym">}</span></li>
<li><a name="a213"></a>&nbsp;</li>
<li><a name="a214"></a>    <span class="src-doc">/**</span></li>
<li><a name="a215"></a><span class="src-doc">     * Sets the last modified time</span></li>
<li><a name="a216"></a><span class="src-doc">     *</span></li>
<li><a name="a217"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">int </span><span class="src-doc-var">$time </span><span class="src-doc">unixtime last modified</span></li>
<li><a name="a218"></a><span class="src-doc">     */</span></li>
<li><a name="a219"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetLastModified">setLastModified</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a220"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$time </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a221"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-str">&quot;Last-Modified&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/gmdate">gmdate</a><span class="src-sym">(</span><span class="src-str">&quot;r&quot;</span><span class="src-sym">, </span><span class="src-var">$time</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a222"></a>        <span class="src-sym">}</span></li>
<li><a name="a223"></a>    <span class="src-sym">}</span></li>
<li><a name="a224"></a>&nbsp;</li>
<li><a name="a225"></a>    <span class="src-doc">/**</span></li>
<li><a name="a226"></a><span class="src-doc">     * Sets the content type of the document</span></li>
<li><a name="a227"></a><span class="src-doc">     *</span></li>
<li><a name="a228"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$type </span><span class="src-doc">content type</span></li>
<li><a name="a229"></a><span class="src-doc">     */</span></li>
<li><a name="a230"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetContentType">setContentType</a><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a231"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$contentType">contentType</a> = <span class="src-var">$type</span><span class="src-sym">;</span></li>
<li><a name="a232"></a>    <span class="src-sym">}</span></li>
<li><a name="a233"></a>&nbsp;</li>
<li><a name="a234"></a>    <span class="src-doc">/**</span></li>
<li><a name="a235"></a><span class="src-doc">    * If noCache is set, disables all http caching</span></li>
<li><a name="a236"></a><span class="src-doc">    * headers according to http://dclp-faq.de/q/q-http-caching.html</span></li>
<li><a name="a237"></a><span class="src-doc">    */</span></li>
<li><a name="a238"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetCacheHeaders">setCacheHeaders</a> <span class="src-sym">(</span><span class="src-var">$noCache</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a239"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$noCache</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a240"></a>            <span class="src-var">$date </span>= <a href="http://www.php.net/gmdate">gmdate</a><span class="src-sym">(</span><span class="src-str">&quot;D, d M Y H:i:s&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a241"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-str">&quot;Expires&quot;</span><span class="src-sym">, </span><span class="src-var">$date </span>. <span class="src-str">&quot; GMT&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a242"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeaderIfNotExists">setHeaderIfNotExists</a><span class="src-sym">(</span><span class="src-str">&quot;Last-Modified&quot;</span><span class="src-sym">,  </span><span class="src-var">$date </span>.<span class="src-str">&quot; GMT&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a243"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-str">&quot;Pragma&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;no-cache&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a244"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-str">&quot;Cache-Control&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;no-cache, post-check=0, pre-check=0&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a245"></a>        <span class="src-sym">}</span></li>
<li><a name="a246"></a>    <span class="src-sym">}</span></li>
<li><a name="a247"></a>    </li>
<li><a name="a248"></a>    <span class="src-doc">/**</span></li>
<li><a name="a249"></a><span class="src-doc">    * Prints all the header in $this-&gt;header</span></li>
<li><a name="a250"></a><span class="src-doc">    *</span></li>
<li><a name="a251"></a><span class="src-doc">    * this function is called from components/serializer.php in the constructor</span></li>
<li><a name="a252"></a><span class="src-doc">    */</span></li>
<li><a name="a253"></a>&nbsp;</li>
<li><a name="a254"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodprintHeader">printHeader</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a255"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodsetHeader">setHeader</a><span class="src-sym">(</span><span class="src-str">&quot;Content-Type&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$contentType">contentType</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a256"></a>        </li>
<li><a name="a257"></a>        <span class="src-comm">// flag for an already sent response header</span></li>
<li><a name="a258"></a>        <span class="src-var">$responseCodeSent </span>= <span class="src-id">FALSE</span><span class="src-sym">;</span></li>
<li><a name="a259"></a>        </li>
<li><a name="a260"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$header">header</a> <span class="src-key">as </span><span class="src-var">$name </span>=&gt; <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a261"></a>            <span class="src-comm">// only send response code with first header</span></li>
<li><a name="a262"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$responseCodeSent</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a263"></a>                <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$name</span>: <span class="src-var">$value</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a264"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a265"></a>                <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$name</span>: <span class="src-var">$value</span></span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-id">TRUE</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$responseCode">responseCode</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a266"></a>                <span class="src-var">$responseCodeSent </span>= <span class="src-id">TRUE</span><span class="src-sym">;</span></li>
<li><a name="a267"></a>            <span class="src-sym">}</span></li>
<li><a name="a268"></a>        <span class="src-sym">}    </span></li>
<li><a name="a269"></a>&nbsp;</li>
<li><a name="a270"></a>    <span class="src-sym">}</span></li>
<li><a name="a271"></a>&nbsp;</li>
<li><a name="a272"></a>&nbsp;</li>
<li><a name="a273"></a>    <span class="src-doc">/**</span></li>
<li><a name="a274"></a><span class="src-doc">     * generates a unique ID out of a string (path+filename)</span></li>
<li><a name="a275"></a><span class="src-doc">     *</span></li>
<li><a name="a276"></a><span class="src-doc">     * This method is used for generating a unique ID for every sitemap</span></li>
<li><a name="a277"></a><span class="src-doc">     *  which has to be compiled. It just takes the realpath as input,</span></li>
<li><a name="a278"></a><span class="src-doc">     *  and returns a unique ID for it.</span></li>
<li><a name="a279"></a><span class="src-doc">     * In this case it replaces every DIRECTORY_SEPERATOR with _ for better</span></li>
<li><a name="a280"></a><span class="src-doc">     *  debugging. Theoretically one could use md5 as well.</span></li>
<li><a name="a281"></a><span class="src-doc">     *</span></li>
<li><a name="a282"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$realpath </span><span class="src-doc">Any string, but in this class normally a fullpath+filename</span></li>
<li><a name="a283"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> public</span></li>
<li><a name="a284"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span><span class="src-doc">ID</span></li>
<li><a name="a285"></a><span class="src-doc">     */</span></li>
<li><a name="a286"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodgenerateSitemapID">generateSitemapID</a> <span class="src-sym">(</span><span class="src-var">$realpath</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a287"></a>        <span class="src-key">return </span><a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-id">DIRECTORY_SEPARATOR</span><span class="src-sym">,</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-str">&quot;_&quot;</span><span class="src-sym">,</span><span class="src-var">$realpath</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a288"></a>    <span class="src-sym">}</span></li>
<li><a name="a289"></a>&nbsp;</li>
<li><a name="a290"></a>    <span class="src-doc">/**</span></li>
<li><a name="a291"></a><span class="src-doc">     * Generates the cached sitemap</span></li>
<li><a name="a292"></a><span class="src-doc">     *</span></li>
<li><a name="a293"></a><span class="src-doc">     * This function generates a php file out of a sitemap.xml with the help</span></li>
<li><a name="a294"></a><span class="src-doc">     *  an xsl file (poponn/sitemap/sitemap2xsl.php)</span></li>
<li><a name="a295"></a><span class="src-doc">     *</span></li>
<li><a name="a296"></a><span class="src-doc">     * Libxslt and Sablotron is supported right now.</span></li>
<li><a name="a297"></a><span class="src-doc">     *</span></li>
<li><a name="a298"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$sitemapRealPath </span><span class="src-doc">the absolute location of sitemap.xml</span></li>
<li><a name="a299"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$sitemapCachedFile </span><span class="src-doc">the absolute location of the cached sitemap (php file)</span></li>
<li><a name="a300"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> public</span></li>
<li><a name="a301"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">bool </span></li>
<li><a name="a302"></a><span class="src-doc">     */</span></li>
<li><a name="a303"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsitemap2php">sitemap2php</a><span class="src-sym">(</span><span class="src-var">$sitemapRealPath</span><span class="src-sym">, </span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a304"></a>        <span class="src-comm">//file_exists and is writable should be the normal case...</span></li>
<li><a name="a305"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">! </span><a href="http://www.php.net/is_writable">is_writable</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">))</span></li>
<li><a name="a306"></a>            <span class="src-sym">{</span></li>
<li><a name="a307"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">! </span><a href="http://www.php.net/realpath">realpath</a><span class="src-sym">(</span><a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)))</span></li>
<li><a name="a308"></a>                    <span class="src-sym">{</span></li>
<li><a name="a309"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/mkdir">mkdir</a><span class="src-sym">(</span><a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span>.<span class="src-str">&quot;/&quot;</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a310"></a>                            <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">&quot;The cache directory &quot;</span>. <a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span>.<span class="src-str">&quot; does not exist&quot; </span><span class="src-sym">,</span><span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a311"></a>                        <span class="src-sym">}</span></li>
<li><a name="a312"></a>                    <span class="src-sym">}</span></li>
<li><a name="a313"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_writable">is_writable</a><span class="src-sym">(</span><a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)))</span></li>
<li><a name="a314"></a>                    <span class="src-sym">{</span></li>
<li><a name="a315"></a>                        <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">&quot;The cache directory  &quot;</span>. <a href="http://www.php.net/realpath">realpath</a><span class="src-sym">(</span><a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">))</span>.<span class="src-str">&quot; is not writable&quot;</span><span class="src-sym">,</span><span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">,</span>__FILE__<span class="src-sym">,</span>__LINE__<span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a316"></a>                    <span class="src-sym">}</span></li>
<li><a name="a317"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/file_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">!</span><a href="http://www.php.net/is_writable">is_writable</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)))</span></li>
<li><a name="a318"></a>                    <span class="src-sym">{</span></li>
<li><a name="a319"></a>                        <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">&quot;The cache file &quot;</span>.<a href="http://www.php.net/realpath">realpath</a><span class="src-sym">(</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span>. <span class="src-str">&quot; is not writable&quot;</span><span class="src-sym">,</span><span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a320"></a>                    <span class="src-sym">}</span></li>
<li><a name="a321"></a>            <span class="src-sym">}</span></li>
<li><a name="a322"></a>&nbsp;</li>
<li><a name="a323"></a>        <span class="src-comm">//check if we have domxml/xslt</span></li>
<li><a name="a324"></a>        </li>
<li><a name="a325"></a>                <span class="src-var">$xslDom </span>= <span class="src-key">new </span><span class="src-id">DomDocument</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a326"></a>                <span class="src-var">$xslDom</span><span class="src-sym">-&gt;</span><span class="src-id">load</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$sm2php_xsl_dir">sm2php_xsl_dir</a>.<span class="src-str">&quot;/&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$sm2php_xsl">sm2php_xsl</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a327"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/class_exists">class_exists</a><span class="src-sym">(</span><span class="src-str">&quot;XsltProcessor&quot;</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a328"></a>                      <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">&quot;Popoon doesn't run without XSLT support in PHP.&quot;</span><span class="src-sym">,</span><span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">,</span>__FILE__<span class="src-sym">,</span>__LINE__<span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a329"></a>                <span class="src-sym">}</span></li>
<li><a name="a330"></a>                <span class="src-var">$xsl </span>= <span class="src-key">new </span><span class="src-id">XsltProcessor</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a331"></a>                <span class="src-var">$xsl</span><span class="src-sym">-&gt;</span><span class="src-id">importStylesheet</span><span class="src-sym">(</span><span class="src-var">$xslDom</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a332"></a>                </li>
<li><a name="a333"></a>                <span class="src-var">$xslincludesDom </span>= <span class="src-key">new </span><span class="src-id">DomDocument</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a334"></a>                <span class="src-var">$xslincludesDom</span><span class="src-sym">-&gt;</span><span class="src-id">load</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$sm2php_xsl_dir">sm2php_xsl_dir</a>.<span class="src-str">&quot;/&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$sm2phpincludes_xsl">sm2phpincludes_xsl</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a335"></a>                <span class="src-var">$xslincludes </span>= <span class="src-key">new </span><span class="src-id">XsltProcessor</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a336"></a>                <span class="src-var">$xslincludes</span><span class="src-sym">-&gt;</span><span class="src-id">importStylesheet</span><span class="src-sym">(</span><span class="src-var">$xslincludesDom</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a337"></a>                </li>
<li><a name="a338"></a>                <span class="src-var">$sm </span>= <span class="src-key">new </span><span class="src-id">DomDocument</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a339"></a>                <span class="src-var">$sm</span><span class="src-sym">-&gt;</span><span class="src-id">load</span><span class="src-sym">(</span><span class="src-var">$sitemapRealPath</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a340"></a>                </li>
<li><a name="a341"></a>                <span class="src-var">$result </span>= <span class="src-var">$xslincludes</span><span class="src-sym">-&gt;</span><span class="src-id">transformToDoc</span><span class="src-sym">(</span><span class="src-var">$sm</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a342"></a>                <span class="src-var">$result </span>= <span class="src-var">$xsl</span><span class="src-sym">-&gt;</span><span class="src-id">transformToUri</span><span class="src-sym">(</span><span class="src-var">$result</span><span class="src-sym">,</span><span class="src-var">$sitemapCachedFile</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a343"></a>&nbsp;</li>
<li><a name="a344"></a>              </li>
<li><a name="a345"></a>&nbsp;</li>
<li><a name="a346"></a>&nbsp;</li>
<li><a name="a347"></a>        <span class="src-key">return </span><span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a348"></a>    <span class="src-sym">}</span></li>
<li><a name="a349"></a>&nbsp;</li>
<li><a name="a350"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodconvertXML">convertXML</a><span class="src-sym">(</span><span class="src-var">$object</span><span class="src-sym">, </span><span class="src-sym">&amp;</span><span class="src-var">$xml</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a351"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$object</span><span class="src-sym">-&gt;</span><span class="src-id">XmlFormat </span>== <span class="src-str">&quot;DomDocument&quot;</span><span class="src-sym">)</span></li>
<li><a name="a352"></a>            <span class="src-sym">{</span></li>
<li><a name="a353"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodvar2XMLObject">var2XMLObject</a><span class="src-sym">(</span><span class="src-var">$xml</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a354"></a>            <span class="src-sym">}</span></li>
<li><a name="a355"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$object</span><span class="src-sym">-&gt;</span><span class="src-id">XmlFormat </span>== <span class="src-str">&quot;XmlString&quot;</span><span class="src-sym">)</span></li>
<li><a name="a356"></a>        <span class="src-sym">{</span></li>
<li><a name="a357"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodvar2XMLString">var2XMLString</a><span class="src-sym">(</span><span class="src-var">$xml</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a358"></a>        <span class="src-sym">}</span></li>
<li><a name="a359"></a>        <span class="src-key">return </span><span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a360"></a>    <span class="src-sym">}</span></li>
<li><a name="a361"></a>&nbsp;</li>
<li><a name="a362"></a>    <span class="src-doc">/**</span></li>
<li><a name="a363"></a><span class="src-doc">     * Converts it's parameter into a DomDocument object</span></li>
<li><a name="a364"></a><span class="src-doc">     *</span></li>
<li><a name="a365"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc"> </span><span class="src-doc-type">mixed </span><span class="src-doc"> xmldoc        can either be a XML String or a DomDocument object</span></li>
<li><a name="a366"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">bool </span></li>
<li><a name="a367"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a368"></a><span class="src-doc">     */</span></li>
<li><a name="a369"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodvar2XMLObject">var2XMLObject</a><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$xmldoc</span><span class="src-sym">)</span></li>
<li><a name="a370"></a>    <span class="src-sym">{</span></li>
<li><a name="a371"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a> <span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">))</span></li>
<li><a name="a372"></a>        <span class="src-sym">{</span></li>
<li><a name="a373"></a>&nbsp;</li>
<li><a name="a374"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/version_compare">version_compare</a><span class="src-sym">(</span><a href="http://www.php.net/phpversion">phpversion</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-str">&quot;4.3.0&quot;</span><span class="src-sym">) </span>&gt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a375"></a>                <span class="src-comm">// we have 4.3, so we can use the &quot;nicer&quot; errorsystem</span></li>
<li><a name="a376"></a>                <span class="src-var">$_xmldoc </span>= <span class="src-id">xmldoc</span><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-sym">&amp;</span><span class="src-var">$errors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a377"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$errors</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a378"></a>                    print <span class="src-str">&quot;&lt;pre&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a379"></a>                    print <span class="src-str">&quot;XML ERRORS!&lt;br/&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a380"></a>                    <a href="http://www.php.net/print_r">print_r</a><span class="src-sym">(</span><span class="src-var">$errors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a381"></a>                    print <span class="src-str">&quot;&lt;hr&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a382"></a>                    print <span class="src-str">&quot;The XML document was:&quot;</span><span class="src-sym">;</span></li>
<li><a name="a383"></a>                    print <span class="src-str">&quot;&lt;hr&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a384"></a>                    print <span class="src-str">&quot;&lt;pre&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a385"></a>                    <span class="src-var">$xmldoc </span>= <a href="http://www.php.net/explode">explode</a> <span class="src-sym">(</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">,</span><span class="src-var">$xmldoc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a386"></a>                    <span class="src-var">$_len </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a387"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$errors </span><span class="src-key">as </span><span class="src-var">$error</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a388"></a>                        <span class="src-var">$lineerrors</span><span class="src-sym">[</span><span class="src-var">$error</span><span class="src-sym">[</span><span class="src-str">'line'</span><span class="src-sym">]] </span>= <span class="src-var">$error</span><span class="src-sym">[</span><span class="src-str">'col'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a389"></a>                    <span class="src-sym">}</span></li>
<li><a name="a390"></a>                    <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-var">$_len</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a391"></a>                        print <a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a392"></a>                        print <span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a393"></a>                        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$lineerrors</span><span class="src-sym">[</span><span class="src-var">$i </span>+ <span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a394"></a>                            print <span class="src-str">&quot;&lt;font color='red'&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a395"></a>                            print <a href="http://www.php.net/str_repeat">str_repeat</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">,</span><span class="src-var">$lineerrors</span><span class="src-sym">[</span><span class="src-var">$i </span>+ <span class="src-num">1</span><span class="src-sym">] </span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a396"></a>                            print <span class="src-str">&quot;^&quot;</span><span class="src-sym">;</span></li>
<li><a name="a397"></a>                            print <span class="src-str">&quot;&lt;/font&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a398"></a>                        <span class="src-sym">}</span></li>
<li><a name="a399"></a>                    <span class="src-sym">}</span></li>
<li><a name="a400"></a>               <span class="src-sym">}</span></li>
<li><a name="a401"></a>               <span class="src-var">$xmldoc </span>= <span class="src-var">$_xmldoc</span><span class="src-sym">;</span></li>
<li><a name="a402"></a>               unset <span class="src-sym">(</span><span class="src-var">$_xmldoc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a403"></a>            <span class="src-sym">}</span></li>
<li><a name="a404"></a>            <span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a405"></a>                <span class="src-var">$xmldoc </span>= <span class="src-id">xmldoc</span><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a406"></a>            <span class="src-sym">}</span></li>
<li><a name="a407"></a>&nbsp;</li>
<li><a name="a408"></a>        <span class="src-sym">}</span></li>
<li><a name="a409"></a>        <span class="src-key">if </span><span class="src-sym">( </span><a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><a href="http://www.php.net/get_class">get_class</a><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">)) </span>!= <span class="src-str">&quot;domdocument&quot;</span><span class="src-sym">)</span></li>
<li><a name="a410"></a>            <span class="src-sym">{</span></li>
<li><a name="a411"></a>                <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">'First parameter to var2XMLObject() is neither a XML String nor a XML DomDocument object. It is: '</span>.</li>
<li><a name="a412"></a>                                          <a href="http://www.php.net/var_export">var_export</a><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">, </span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a413"></a>                                          <span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a414"></a>            <span class="src-sym">}</span></li>
<li><a name="a415"></a>        <span class="src-key">return </span><span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a416"></a>    <span class="src-sym">}</span></li>
<li><a name="a417"></a>&nbsp;</li>
<li><a name="a418"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodredirectTo">redirectTo</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a419"></a>        <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">&quot;Location: &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a420"></a>        <span class="src-key">exit</span><span class="src-sym">;</span></li>
<li><a name="a421"></a>    <span class="src-sym">}</span></li>
<li><a name="a422"></a>&nbsp;</li>
<li><a name="a423"></a>    <span class="src-doc">/**</span></li>
<li><a name="a424"></a><span class="src-doc">     * Converts it's parameter into a XML String</span></li>
<li><a name="a425"></a><span class="src-doc">     *</span></li>
<li><a name="a426"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc"> </span><span class="src-doc-type">mixed </span><span class="src-doc"> xmldoc        can either be a XML String or a DomDocument object</span></li>
<li><a name="a427"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">bool </span></li>
<li><a name="a428"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a429"></a><span class="src-doc">     */</span></li>
<li><a name="a430"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodvar2XMLString">var2XMLString</a><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$xmldoc</span><span class="src-sym">)</span></li>
<li><a name="a431"></a>    <span class="src-sym">{</span></li>
<li><a name="a432"></a>        <span class="src-key">if </span><span class="src-sym">( </span><a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><a href="http://www.php.net/get_class">get_class</a><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">)) </span>== <span class="src-str">&quot;domdocument&quot;</span><span class="src-sym">)</span></li>
<li><a name="a433"></a>        <span class="src-sym">{</span></li>
<li><a name="a434"></a>            <span class="src-var">$xmldoc </span>= <span class="src-var">$xmldoc</span><span class="src-sym">-&gt;</span><span class="src-id">saveXML</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a435"></a>        <span class="src-sym">}</span></li>
<li><a name="a436"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a> <span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">))</span></li>
<li><a name="a437"></a>            <span class="src-sym">{</span></li>
<li><a name="a438"></a>                <span class="src-key">return </span><span class="src-id"><a href="../popoon/popoon.html">popoon</a></span><span class="src-sym">::</span><a href="../popoon/popoon.html#methodraiseError">raiseError</a><span class="src-sym">(</span><span class="src-str">'First parameter to var2XMLString() is neither a XML String nor a XML DomDocument object. It is: '</span>.</li>
<li><a name="a439"></a>                                          <a href="http://www.php.net/var_export">var_export</a><span class="src-sym">(</span><span class="src-var">$xmldoc</span><span class="src-sym">, </span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a440"></a>                                          <span class="src-id"><a href="../popoon/_popoon_php.html#definePOPOON_ERROR_FATAL">POPOON_ERROR_FATAL</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a441"></a>            <span class="src-sym">}</span></li>
<li><a name="a442"></a>        <span class="src-key">else</span></li>
<li><a name="a443"></a>            <span class="src-sym">{</span></li>
<li><a name="a444"></a>                <span class="src-key">return </span><span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a445"></a>            <span class="src-sym">}</span></li>
<li><a name="a446"></a>    <span class="src-sym">}</span></li>
<li><a name="a447"></a>&nbsp;</li>
<li><a name="a448"></a>    <span class="src-comm">/* in the array doNotTranslate we can give some values, which should not be translated, as for example http...*/</span></li>
<li><a name="a449"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$doNotTranslate </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a450"></a>        <span class="src-comm">// don't do anything, if we don't have any scheme stuff in the $value;</span></li>
<li><a name="a451"></a>        <span class="src-comm">// strpos should be rather fast, i assume.</span></li>
<li><a name="a452"></a>&nbsp;</li>
<li><a name="a453"></a>        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-str">&quot;:/&quot;</span><span class="src-sym">) </span>=== <span class="src-id">false </span>&amp;&amp; <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-str">&quot;{&quot;</span><span class="src-sym">) </span>=== <span class="src-id">false</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-key">return </span><span class="src-var">$value</span><span class="src-sym">;</span><span class="src-sym">}</span></li>
<li><a name="a454"></a>&nbsp;</li>
<li><a name="a455"></a>        <span class="src-var">$scheme </span>= <span class="src-id"><a href="../popoon/popoon_sitemap.html">popoon_sitemap</a></span><span class="src-sym">::</span><a href="../popoon/popoon_sitemap.html#methodgetSchemeParts">getSchemeParts</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a456"></a>&nbsp;</li>
<li><a name="a457"></a>        <span class="src-comm">//checks if value  ends with } and starts with { with no { after the first position</span></li>
<li><a name="a458"></a>        <span class="src-comm">// then we don't need this fairly complicated preg from below and can substitute also arrays and alike</span></li>
<li><a name="a459"></a>&nbsp;</li>
<li><a name="a460"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a> <span class="src-sym">(</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">, </span>-<span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">) </span>== <span class="src-str">&quot;}&quot; </span>&amp;&amp; <a href="http://www.php.net/strrpos">strrpos</a> <span class="src-sym">( </span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">&quot;{&quot;</span><span class="src-sym">) </span>=== <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a461"></a>            <span class="src-sym">{</span></li>
<li><a name="a462"></a>            <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a463"></a>&nbsp;</li>
<li><a name="a464"></a>            <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span>= <span class="src-sym">@</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$maps">maps</a><span class="src-sym">[</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-str">'../'</span><span class="src-sym">)</span><span class="src-sym">]</span><span class="src-sym">[</span><a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;../&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a465"></a>            <span class="src-sym">}</span></li>
<li><a name="a466"></a>        <span class="src-key">else</span></li>
<li><a name="a467"></a>            <span class="src-sym">{</span></li>
<li><a name="a468"></a>&nbsp;</li>
<li><a name="a469"></a>                <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;#\{([\./]*([^}]+))\}#e&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;</span><span class="src-str">\$<span class="src-id">this</span><span class="src-sym">-&gt;</span><span class="src-id">translateSchemeSubParts</span>('$1','$2')</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a470"></a>            <span class="src-sym">}</span></li>
<li><a name="a471"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$doNotTranslate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a472"></a>            <span class="src-key">return </span><span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a473"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">] </span>!= <span class="src-str">&quot;default&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a474"></a>            <span class="src-inc">include_once</span><span class="src-sym">(</span><span class="src-str">&quot;popoon/components/schemes/&quot;</span>.<span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">]</span>.<span class="src-str">&quot;.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a475"></a>            <span class="src-key">return </span><a href="http://www.php.net/call_user_func">call_user_func</a><span class="src-sym">(</span><span class="src-str">&quot;scheme_&quot;</span>.<span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-sym">&amp;</span><span class="src-var">$this</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a476"></a>        <span class="src-sym">}</span></li>
<li><a name="a477"></a>        <span class="src-key">else</span></li>
<li><a name="a478"></a>            <span class="src-sym">{</span></li>
<li><a name="a479"></a>                <span class="src-key">return </span><span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a480"></a>            <span class="src-sym">}</span></li>
<li><a name="a481"></a>    <span class="src-sym">}</span></li>
<li><a name="a482"></a>    </li>
<li><a name="a483"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodtranslateSchemeSubParts">translateSchemeSubParts</a> <span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$value2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a484"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-str">&quot;:/&quot;</span><span class="src-sym">) </span>=== <span class="src-id">false</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a485"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$maps">maps</a><span class="src-sym">[</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-str">'../'</span><span class="src-sym">)</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$value2</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a486"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a487"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a488"></a>        <span class="src-sym">}</span></li>
<li><a name="a489"></a>    <span class="src-sym">}</span></li>
<li><a name="a490"></a>        </li>
<li><a name="a491"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodgetSchemeParts">getSchemeParts</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a492"></a>        <span class="src-var">$scheme </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a493"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">#^'(.*)'$#</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$match</span><span class="src-sym">))</span></li>
<li><a name="a494"></a>            <span class="src-sym">{</span></li>
<li><a name="a495"></a>                <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">] </span>= <span class="src-str">&quot;default&quot;</span><span class="src-sym">;</span></li>
<li><a name="a496"></a>                <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a497"></a>            <span class="src-sym">}</span></li>
<li><a name="a498"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#^([_a-zA-Z0-9]+)://(.*)#&quot;</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$match</span><span class="src-sym">))</span></li>
<li><a name="a499"></a>        <span class="src-sym">{</span></li>
<li><a name="a500"></a>            <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">] </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a501"></a>            <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a502"></a>        <span class="src-sym">}</span></li>
<li><a name="a503"></a>        <span class="src-key">else</span></li>
<li><a name="a504"></a>            <span class="src-sym">{</span></li>
<li><a name="a505"></a>                <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;scheme&quot;</span><span class="src-sym">] </span>= <span class="src-str">&quot;default&quot;</span><span class="src-sym">;</span></li>
<li><a name="a506"></a>                <span class="src-var">$scheme</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">] </span>= <span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a507"></a>            <span class="src-sym">}</span></li>
<li><a name="a508"></a>        <span class="src-key">return </span><span class="src-var">$scheme</span><span class="src-sym">;</span></li>
<li><a name="a509"></a>    <span class="src-sym">}</span></li>
<li><a name="a510"></a>&nbsp;</li>
<li><a name="a511"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodaddMap">addMap</a><span class="src-sym">(</span><span class="src-var">$map</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a512"></a>        <a href="http://www.php.net/array_unshift">array_unshift</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$maps">maps</a><span class="src-sym">,</span><span class="src-var">$map</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a513"></a>    <span class="src-sym">}</span></li>
<li><a name="a514"></a>&nbsp;</li>
<li><a name="a515"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodremoveMap">removeMap</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a516"></a>        <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$maps">maps</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a517"></a>    <span class="src-sym">}</span></li>
<li><a name="a518"></a>&nbsp;</li>
<li><a name="a519"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetGlobalOptions">setGlobalOptions</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">, </span><span class="src-var">$data</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a520"></a>        <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">options</span><span class="src-sym">[</span><span class="src-var">$name</span><span class="src-sym">] </span>= <span class="src-var">$data</span><span class="src-sym">;</span></li>
<li><a name="a521"></a>    <span class="src-sym">}</span></li>
<li><a name="a522"></a>&nbsp;</li>
<li><a name="a523"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodsetGlobalOptionsAll">setGlobalOptionsAll</a><span class="src-sym">( </span><span class="src-var">$data</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a524"></a>        <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">options </span>= <span class="src-var">$data</span><span class="src-sym">;</span></li>
<li><a name="a525"></a>    <span class="src-sym">}</span></li>
<li><a name="a526"></a>&nbsp;</li>
<li><a name="a527"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodgetGlobalOptions">getGlobalOptions</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a528"></a>        <span class="src-key">return </span><span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">options</span><span class="src-sym">[</span><span class="src-var">$name</span><span class="src-sym">] </span><span class="src-sym">;</span></li>
<li><a name="a529"></a>    <span class="src-sym">}</span></li>
<li><a name="a530"></a>&nbsp;</li>
<li><a name="a531"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodgetGlobalOptionsAll">getGlobalOptionsAll</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a532"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">options</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a533"></a>            <span class="src-key">return </span><span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">options </span><span class="src-sym">;</span></li>
<li><a name="a534"></a>        <span class="src-sym">}</span></li>
<li><a name="a535"></a>        <span class="src-key">else</span></li>
<li><a name="a536"></a>        <span class="src-sym">{</span></li>
<li><a name="a537"></a>            <span class="src-key">return </span><span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a538"></a>        <span class="src-sym">}</span></li>
<li><a name="a539"></a>    <span class="src-sym">}</span></li>
<li><a name="a540"></a>&nbsp;</li>
<li><a name="a541"></a>&nbsp;</li>
<li><a name="a542"></a>    <span class="src-doc">/**</span></li>
<li><a name="a543"></a><span class="src-doc">     * Mounts a second sitemap</span></li>
<li><a name="a544"></a><span class="src-doc">     *</span></li>
<li><a name="a545"></a><span class="src-doc">     * Not a very elegant solution, should be rewritten some day</span></li>
<li><a name="a546"></a><span class="src-doc">     *</span></li>
<li><a name="a547"></a><span class="src-doc">     */</span></li>
<li><a name="a548"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#method_mount">_mount</a><span class="src-sym">(</span><span class="src-var">$attribs</span><span class="src-sym">)</span></li>
<li><a name="a549"></a>    <span class="src-sym">{</span></li>
<li><a name="a550"></a>        <span class="src-var">$file </span>= <span class="src-id"><a href="../popoon/popoon_sitemap.html">popoon_sitemap</a></span><span class="src-sym">::</span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;src&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a551"></a>         <span class="src-var">$old_uri </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a><span class="src-sym">;</span></li>
<li><a name="a552"></a>&nbsp;</li>
<li><a name="a553"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;uri-prefix&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a554"></a>            <span class="src-sym">{</span></li>
<li><a name="a555"></a>                <span class="src-var">$prefix </span>= <span class="src-id"><a href="../popoon/popoon_sitemap.html">popoon_sitemap</a></span><span class="src-sym">::</span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;uri-prefix&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a556"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$prefix</span><span class="src-sym">)</span></li>
<li><a name="a557"></a>                    <span class="src-sym">{</span></li>
<li><a name="a558"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a> = <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">#^/*<span class="src-var">$prefix</span>/*#</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a559"></a>                    <span class="src-sym">}</span></li>
<li><a name="a560"></a>&nbsp;</li>
<li><a name="a561"></a>            <span class="src-sym">}</span></li>
<li><a name="a562"></a>        <span class="src-comm">// I hope, this doesn't have too many sideeffects</span></li>
<li><a name="a563"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#method__construct">__construct</a><span class="src-sym">(</span><span class="src-var">$file</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a564"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$uri">uri</a> =     <span class="src-var">$old_uri</span><span class="src-sym">;</span></li>
<li><a name="a565"></a>    <span class="src-sym">}</span></li>
<li><a name="a566"></a>&nbsp;</li>
<li><a name="a567"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#method_scheme">_scheme</a><span class="src-sym">(</span><span class="src-var">$attribs</span><span class="src-sym">)</span></li>
<li><a name="a568"></a>    <span class="src-sym">{</span></li>
<li><a name="a569"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a570"></a>            <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">] </span>= <span class="src-key">new </span><span class="src-id">stdClass</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a571"></a>        <span class="src-sym">}</span></li>
<li><a name="a572"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset <span class="src-sym">(</span><span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">schemes</span><span class="src-sym">))</span></li>
<li><a name="a573"></a>            <span class="src-sym">{</span></li>
<li><a name="a574"></a>                </li>
<li><a name="a575"></a>                <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">schemes </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a576"></a>            <span class="src-sym">}</span></li>
<li><a name="a577"></a>        <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">schemes</span><span class="src-sym">[</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;name&quot;</span><span class="src-sym">]] </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a578"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;subname&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a579"></a>            <span class="src-sym">{</span></li>
<li><a name="a580"></a>                <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">schemes</span><span class="src-sym">[</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;name&quot;</span><span class="src-sym">]]</span><span class="src-sym">[</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;subname&quot;</span><span class="src-sym">]]  </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a581"></a>                <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$attribs </span><span class="src-key">as </span><span class="src-var">$value </span>=&gt; <span class="src-var">$key</span><span class="src-sym">)</span></li>
<li><a name="a582"></a>                <span class="src-sym">{</span></li>
<li><a name="a583"></a>                    <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">schemes</span><span class="src-sym">[</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;name&quot;</span><span class="src-sym">]]</span><span class="src-sym">[</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;subname&quot;</span><span class="src-sym">]]</span><span class="src-sym">[</span><span class="src-var">$value</span><span class="src-sym">] </span>=   <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a584"></a>                <span class="src-sym">}</span></li>
<li><a name="a585"></a>            <span class="src-sym">}</span></li>
<li><a name="a586"></a>        <span class="src-key">else</span></li>
<li><a name="a587"></a>            <span class="src-sym">{</span></li>
<li><a name="a588"></a>                <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$attribs </span><span class="src-key">as </span><span class="src-var">$value </span>=&gt; <span class="src-var">$key</span><span class="src-sym">)</span></li>
<li><a name="a589"></a>                <span class="src-sym">{</span></li>
<li><a name="a590"></a>                    <span class="src-var">$GLOBALS</span><span class="src-sym">[</span><span class="src-str">&quot;_POPOON_globalContainer&quot;</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">schemes</span><span class="src-sym">[</span><span class="src-var">$attribs</span><span class="src-sym">[</span><span class="src-str">&quot;name&quot;</span><span class="src-sym">]]</span><span class="src-sym">[</span><span class="src-var">$value</span><span class="src-sym">] </span>=   <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#methodtranslateScheme">translateScheme</a><span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a591"></a>                <span class="src-sym">}</span></li>
<li><a name="a592"></a>            <span class="src-sym">}</span></li>
<li><a name="a593"></a>&nbsp;</li>
<li><a name="a594"></a>    <span class="src-sym">}</span></li>
<li><a name="a595"></a>&nbsp;</li>
<li><a name="a596"></a>    <span class="src-doc">/**</span></li>
<li><a name="a597"></a><span class="src-doc">     * Starts component caching</span></li>
<li><a name="a598"></a><span class="src-doc">     *</span></li>
<li><a name="a599"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc"> </span><span class="src-doc-type">array </span><span class="src-doc"> Attributes of current pipeline</span></li>
<li><a name="a600"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@see</span><span class="src-doc">    disableCaching(), $componentCache</span></li>
<li><a name="a601"></a><span class="src-doc">     */</span></li>
<li><a name="a602"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methodenableCaching">enableCaching</a><span class="src-sym">(</span><span class="src-var">$pipelineAttribs</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a603"></a>        <span class="src-inc">include</span><span class="src-sym">(</span><span class="src-str">'popoon/components/cache.php'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a604"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$componentCache">componentCache</a> = <span class="src-key">new </span><span class="src-id">ComponentCache</span><span class="src-sym">(</span><span class="src-var">$pipelineAttribs</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a605"></a>    <span class="src-sym">}</span></li>
<li><a name="a606"></a>&nbsp;</li>
<li><a name="a607"></a>    <span class="src-doc">/**</span></li>
<li><a name="a608"></a><span class="src-doc">     * Disables component caching</span></li>
<li><a name="a609"></a><span class="src-doc">     *</span></li>
<li><a name="a610"></a><span class="src-doc">     * Reset $this-&gt;componentCache</span></li>
<li><a name="a611"></a><span class="src-doc">     *</span></li>
<li><a name="a612"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@see</span><span class="src-doc">    enableCaching(), $componentCache</span></li>
<li><a name="a613"></a><span class="src-doc">     */</span></li>
<li><a name="a614"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methoddisableCaching">disableCaching</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a615"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$componentCache">componentCache</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a616"></a>    <span class="src-sym">}</span></li>
<li><a name="a617"></a>&nbsp;</li>
<li><a name="a618"></a>    <span class="src-key">function </span><a href="../popoon/popoon_sitemap.html#methoddisableOutputCaching">disableOutputCaching</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a619"></a>       <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../popoon/popoon_sitemap.html#var$options">options</a><span class="src-sym">-&gt;</span><span class="src-id">disableOutputCaching</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a620"></a>    <span class="src-sym">}</span></li>
<li><a name="a621"></a>&nbsp;</li>
<li><a name="a622"></a><span class="src-sym">}</span></li>
<li><a name="a623"></a>&nbsp;</li>
<li><a name="a624"></a><span class="src-php">?&gt;</span></li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon,  8 Mar 2004 08:34:07 +0100 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC2</a>
	</p>
	</body>
</html>